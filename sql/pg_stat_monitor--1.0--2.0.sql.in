/* contrib/pg_stat_monitor/pg_stat_monitor--1.0--2.0.sql */

-- complain if script is sourced in psql, rather than via ALTER EXTENSION       
\echo Use "ALTER EXTENSION pg_stat_monitor UPDATE TO '2.0'" to load this file. \quit

CREATE FUNCTION pg_stat_monitor_errors(
    OUT message    text,
    OUT msgtime    text,
    OUT calls      int8
 )
RETURNS SETOF record
AS 'MODULE_PATHNAME', 'pg_stat_monitor_errors'
LANGUAGE C STRICT VOLATILE PARALLEL SAFE;

CREATE VIEW pg_stat_monitor_errors AS SELECT
    message, msgtime, calls
 FROM pg_stat_monitor_errors();
 
 CREATE FUNCTION pg_stat_monitor_reset_errors()
 RETURNS void
AS 'MODULE_PATHNAME'
LANGUAGE C PARALLEL SAFE;

GRANT SELECT ON pg_stat_monitor_errors TO PUBLIC;
REVOKE ALL ON FUNCTION pg_stat_monitor_reset_errors() FROM PUBLIC;

